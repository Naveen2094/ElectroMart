<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Checkout | ElectroMart</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<header class="navbar">
  <div class="logo">⚡ Electro<span>Mart</span></div>
  <nav>
    <a href="index.html">Home</a>
    <a href="products.html">Products</a>
    <a href="cart.html">Cart</a>


  </nav>
</header>

<section class="checkout">
  <h2 class="section-title">Checkout</h2>

  <div class="checkout-grid">

    <!-- Address -->
    <div class="checkout-box">
      <h3>Delivery Address</h3>
      <input type="text" placeholder="Full Name">
      <input type="text" placeholder="Address">
      <input type="text" placeholder="City">
      <input type="text" placeholder="Pincode">
    </div>

    <!-- Payment -->
    <div class="checkout-box">
  <h3>Payment Method</h3>

  <label>
    <input type="radio" name="payment" value="cod" checked>
    Cash on Delivery
  </label><br>

  <label>
    <input type="radio" name="payment" value="upi">
    UPI
  </label><br>

  <label>
    <input type="radio" name="payment" value="card">
    Credit / Debit Card
  </label>
</div>


  <button class="hero-btn" onclick="placeOrder()">Place Order</button>


</section>

<footer class="footer">
  <p>© 2025 ElectroMart. All rights reserved.</p>
</footer>
<script>
  const cart = JSON.parse(localStorage.getItem("cart")) || [];

  if (cart.length === 0) {
    alert("Your cart is empty. Please add products first.");
    window.location.href = "products.html";
  }
</script>

<script>
function placeOrder() {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  if (cart.length === 0) {
    alert("Cart is empty");
    return;
  }

  const name = document.querySelector('input[placeholder="Full Name"]').value;
  const address = document.querySelector('input[placeholder="Address"]').value;
  const city = document.querySelector('input[placeholder="City"]').value;
  const pincode = document.querySelector('input[placeholder="Pincode"]').value;
  const payment = document.querySelector('input[name="payment"]:checked').value;

  if (!name || !address || !city || !pincode) {
    alert("Please fill all address details");
    return;
  }

  let total = 0;
  cart.forEach(i => {
    const price = parseInt(i.price.replace(/[^0-9]/g, ""));
    total += price * i.quantity;
  });

  fetch("backend/place-order.php", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    customer_name: name,
    address: address + ", " + city + " - " + pincode,
    payment_method: payment,
    total_amount: total
  })
})

  .then(res => res.json())
  .then(data => {
    if (data.success) {
      localStorage.removeItem("cart");
      window.location.href = "order-success.html";
    } else {
      alert("Order failed. Please try again.");
    }
  })
  .catch(err => {
    console.error("Order error:", err);
  });
}
</script>



</body>
</html>
